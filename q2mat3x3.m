function mat3x3 = q2mat3x3(q)
%     t11 = q(1)^2+q(2)^2-q(3)^2-q(4)^2;    t12 = 2*(q(2)*q(3)+q(1)*q(4));    t13 = 2*(q(2)*q(4)-q(1)*q(3));
%     t21 = 2*(q(2)*q(3)-q(1)*q(4));    t22 = q(1)^2-q(2)^2+q(3)^2-q(4)^2;    t23 = 2*(q(3)*q(4)+q(1)*q(2));
%     t31 = 2*(q(2)*q(4)+q(1)*q(3));    t32 = 2*(q(3)*q(4)-q(1)*q(2));    t33 = q(1)^2-q(2)^2-q(3)^2+q(4)^2;
%     mat3x3 = [t11 t12 t13;t21 t22 t23;t31 t32 t33];   
 mat3x3 =[  q(1)^2+q(2)^2-q(3)^2-q(4)^2 2*(q(2)*q(3)+q(1)*q(4))         2*(q(2)*q(4)-q(1)*q(3)) ;
            2*(q(2)*q(3)-q(1)*q(4))     q(1)^2-q(2)^2+q(3)^2-q(4)^2     2*(q(3)*q(4)+q(1)*q(2)) ;
            2*(q(2)*q(4)+q(1)*q(3))     2*(q(3)*q(4)-q(1)*q(2))         q(1)^2-q(2)^2-q(3)^2+q(4)^2];

end